<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Linear Regression in R | Fundamentals of Mathematics and Statistics with R</title>
  <meta name="description" content="Linear Regression in R | Fundamentals of Mathematics and Statistics with R" />
<<<<<<< HEAD
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />
=======
<<<<<<< HEAD
  <meta name="generator" content="bookdown 0.29.3 and GitBook 2.6.7" />
=======
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />
>>>>>>> db2d36962e520f9ed1862fd4eb2c519e8da84f67
>>>>>>> 6da6143e6ad07463649fb2aae6d4caebd3bea4f0

  <meta property="og:title" content="Linear Regression in R | Fundamentals of Mathematics and Statistics with R" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Linear Regression in R | Fundamentals of Mathematics and Statistics with R" />
  
  
  

<meta name="author" content="Dr. Priyanga D. Talagala" />


<<<<<<< HEAD
<meta name="date" content="2023-10-17" />
=======
<<<<<<< HEAD
<meta name="date" content="2023-03-30" />
=======
<meta name="date" content="2023-01-14" />
>>>>>>> db2d36962e520f9ed1862fd4eb2c519e8da84f67
>>>>>>> 6da6143e6ad07463649fb2aae6d4caebd3bea4f0

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-distributions.html"/>
<link rel="next" href="mtcars.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Fundamentals of Mathematics and Statistics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction to R, Rstudio and Posit Cloud</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Installing R and Rstudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="intro.html"><a href="intro.html#posit-cloud"><i class="fa fa-check"></i><b>1.1.1</b> Posit Cloud</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#rstudio-layout"><i class="fa fa-check"></i><b>1.2</b> RStudio layout</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#installing-an-r-package"><i class="fa fa-check"></i><b>1.3</b> Installing an R Package</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#loading-an-r-packages"><i class="fa fa-check"></i><b>1.4</b> Loading an R Packages</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#getting-started-with-r"><i class="fa fa-check"></i><b>1.5</b> Getting started with R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="differentiation.html"><a href="differentiation.html"><i class="fa fa-check"></i><b>2</b> Differentiation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="differentiation.html"><a href="differentiation.html#higher-derivatives"><i class="fa fa-check"></i><b>2.1</b> Higher Derivatives</a></li>
<li class="chapter" data-level="2.2" data-path="differentiation.html"><a href="differentiation.html#partial-derivatives"><i class="fa fa-check"></i><b>2.2</b> Partial Derivatives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="statistical-distributions.html"><a href="statistical-distributions.html"><i class="fa fa-check"></i><b>3</b> Statistical Distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#pxxx"><i class="fa fa-check"></i><b>3.1</b> pxxx</a></li>
<li class="chapter" data-level="3.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#qxxx"><i class="fa fa-check"></i><b>3.2</b> qxxx</a></li>
<li class="chapter" data-level="3.3" data-path="statistical-distributions.html"><a href="statistical-distributions.html#dxxx"><i class="fa fa-check"></i><b>3.3</b> dxxx</a></li>
<li class="chapter" data-level="3.4" data-path="statistical-distributions.html"><a href="statistical-distributions.html#rxxx"><i class="fa fa-check"></i><b>3.4</b> rxxx</a></li>
<li class="chapter" data-level="3.5" data-path="statistical-distributions.html"><a href="statistical-distributions.html#distributions-in-r"><i class="fa fa-check"></i><b>3.5</b> Distributions in R</a></li>
<li class="chapter" data-level="3.6" data-path="statistical-distributions.html"><a href="statistical-distributions.html#exercise"><i class="fa fa-check"></i><b>3.6</b> Exercise</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#normal"><i class="fa fa-check"></i><b>3.6.1</b> Normal</a></li>
<li class="chapter" data-level="3.6.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#gamma"><i class="fa fa-check"></i><b>3.6.2</b> Gamma</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="statistical-distributions.html"><a href="statistical-distributions.html#references"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html"><i class="fa fa-check"></i>Linear Regression in R</a>
<ul>
<li class="chapter" data-level="3.8" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#loading-required-r-packages"><i class="fa fa-check"></i><b>3.8</b> Loading required R packages</a></li>
<li class="chapter" data-level="3.9" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#load-data-set"><i class="fa fa-check"></i><b>3.9</b> Load Data set</a></li>
<li class="chapter" data-level="3.10" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#explore-data"><i class="fa fa-check"></i><b>3.10</b> Explore data</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#scatterplot"><i class="fa fa-check"></i><b>3.10.1</b> Scatterplot</a></li>
<li class="chapter" data-level="3.10.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#scatterplot-matrix"><i class="fa fa-check"></i><b>3.10.2</b> Scatterplot matrix</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.11</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#residual-analysis"><i class="fa fa-check"></i><b>3.11.1</b> Residual Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#multiple-linear-regression"><i class="fa fa-check"></i><b>3.12</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#how-to-test-if-your-linear-model-has-a-good-fit"><i class="fa fa-check"></i><b>3.12.1</b> How to test if your linear model has a good fit?</a></li>
<li class="chapter" data-level="3.12.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#dont-forget-to-look-at-the-residuals"><i class="fa fa-check"></i><b>3.12.2</b> Don’t forget to look at the residuals</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#prediction-for-new-data-set"><i class="fa fa-check"></i><b>3.13</b> Prediction for new data set</a></li>
<li class="chapter" data-level="3.14" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#references-1"><i class="fa fa-check"></i><b>3.14</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="mtcars.html"><a href="mtcars.html"><i class="fa fa-check"></i><b>4</b> mtcars</a></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="5" data-path="intro1.html"><a href="intro1.html"><i class="fa fa-check"></i><b>5</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="intro1.html"><a href="intro1.html#installing-r"><i class="fa fa-check"></i><b>5.1</b> Installing R</a></li>
<li class="chapter" data-level="5.2" data-path="intro1.html"><a href="intro1.html#rstudio-layout-1"><i class="fa fa-check"></i><b>5.2</b> RStudio layout</a></li>
<li class="chapter" data-level="5.3" data-path="intro1.html"><a href="intro1.html#installing-an-r-package-1"><i class="fa fa-check"></i><b>5.3</b> Installing an R Package</a></li>
<li class="chapter" data-level="5.4" data-path="intro1.html"><a href="intro1.html#loading-an-r-packages-1"><i class="fa fa-check"></i><b>5.4</b> Loading an R Packages</a></li>
<li class="chapter" data-level="5.5" data-path="intro1.html"><a href="intro1.html#getting-started-with-r-1"><i class="fa fa-check"></i><b>5.5</b> Getting started with R</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fundamentals of Mathematics and Statistics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression-in-r" class="section level1 unnumbered hasAnchor">
<h1>Linear Regression in R<a href="linear-regression-in-r.html#linear-regression-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In many practical situations we want to identify various types of relationships between variables. <strong>Regression analysis</strong> is a statistical technique for investigating and <strong>modeling the relationship between variables</strong>.</p>
<p><strong>Linear regression</strong> attempts to model the relationship between a scalar response (or dependent variable) and one or more explanatory variables (or independent variables) by fitting a <strong>linear equation</strong> to observed data. The case of one explanatory variable is called <strong>simple linear regression.</strong></p>
<div id="loading-required-r-packages" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Loading required R packages<a href="linear-regression-in-r.html#loading-required-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following R packages are required for this chapter:</p>
<ul>
<li><code>ggplot2</code> for data visualization</li>
<li><code>datarium</code> data bank for statistical analysis and visualization</li>
<li>The <code>ggpairs()</code> function of the <code>GGally</code> package allows to build a great scatterplot matrix.</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="linear-regression-in-r.html#cb69-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb69-2"><a href="linear-regression-in-r.html#cb69-2" tabindex="-1"></a><span class="fu">library</span>(datarium)</span>
<span id="cb69-3"><a href="linear-regression-in-r.html#cb69-3" tabindex="-1"></a><span class="do">## To learn more about the dataset</span></span>
<span id="cb69-4"><a href="linear-regression-in-r.html#cb69-4" tabindex="-1"></a><span class="co"># ?marketing</span></span>
<span id="cb69-5"><a href="linear-regression-in-r.html#cb69-5" tabindex="-1"></a></span>
<span id="cb69-6"><a href="linear-regression-in-r.html#cb69-6" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<ul>
<li>We are going to use the marketing data set available in <code>datarium</code> package, which contains the impact of the amount of money spent on three advertising medias (youtube, Facebook and newspaper) on sales.</li>
</ul>
</div>
<div id="load-data-set" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Load Data set<a href="linear-regression-in-r.html#load-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<<<<<<< HEAD
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="linear-regression-in-r.html#cb70-1" tabindex="-1"></a><span class="fu">data</span>(marketing)</span>
<span id="cb70-2"><a href="linear-regression-in-r.html#cb70-2" tabindex="-1"></a><span class="fu">head</span>(marketing)</span></code></pre></div>
=======
<<<<<<< HEAD
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="linear-regression-in-r.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(marketing)</span>
<span id="cb72-2"><a href="linear-regression-in-r.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(marketing)</span></code></pre></div>
=======
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="linear-regression-in-r.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(marketing)</span>
<span id="cb70-2"><a href="linear-regression-in-r.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(marketing)</span></code></pre></div>
>>>>>>> db2d36962e520f9ed1862fd4eb2c519e8da84f67
>>>>>>> 6da6143e6ad07463649fb2aae6d4caebd3bea4f0
<pre><code>##   youtube facebook newspaper sales
## 1  276.12    45.36     83.04 26.52
## 2   53.40    47.16     54.12 12.48
## 3   20.64    55.08     83.16 11.16
## 4  181.80    49.56     70.20 22.20
## 5  216.96    12.96     70.08 15.48
## 6   10.44    58.68     90.00  8.64</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="linear-regression-in-r.html#cb72-1" tabindex="-1"></a><span class="fu">summary</span>(marketing)</span></code></pre></div>
<pre><code>##     youtube          facebook       newspaper          sales      
##  Min.   :  0.84   Min.   : 0.00   Min.   :  0.36   Min.   : 1.92  
##  1st Qu.: 89.25   1st Qu.:11.97   1st Qu.: 15.30   1st Qu.:12.45  
##  Median :179.70   Median :27.48   Median : 30.90   Median :15.48  
##  Mean   :176.45   Mean   :27.92   Mean   : 36.66   Mean   :16.83  
##  3rd Qu.:262.59   3rd Qu.:43.83   3rd Qu.: 54.12   3rd Qu.:20.88  
##  Max.   :355.68   Max.   :59.52   Max.   :136.80   Max.   :32.40</code></pre>
</div>
<div id="explore-data" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Explore data<a href="linear-regression-in-r.html#explore-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="scatterplot" class="section level3 hasAnchor" number="3.10.1">
<h3><span class="header-section-number">3.10.1</span> Scatterplot<a href="linear-regression-in-r.html#scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Usually, the first step in regression analysis is to construct a scatter plot (or scatter matrix).</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="linear-regression-in-r.html#cb74-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> marketing, <span class="fu">aes</span>(<span class="at">x =</span> facebook, <span class="at">y =</span> sales)) <span class="sc">+</span></span>
<span id="cb74-2"><a href="linear-regression-in-r.html#cb74-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-3"><a href="linear-regression-in-r.html#cb74-3" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb74-4"><a href="linear-regression-in-r.html#cb74-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sales&quot;</span>)<span class="sc">+</span></span>
<span id="cb74-5"><a href="linear-regression-in-r.html#cb74-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;facebook&quot;</span>)</span></code></pre></div>
<p><img src="figure/unnamed-chunk-26-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="scatterplot-matrix" class="section level3 hasAnchor" number="3.10.2">
<h3><span class="header-section-number">3.10.2</span> Scatterplot matrix<a href="linear-regression-in-r.html#scatterplot-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The <code>ggpairs()</code> function of the <code>GGally</code> package allows to build a great scatterplot matrix.</li>
<li>Scatterplots of each pair of numeric variable are drawn on the left part of the figure.</li>
<li>Pearson correlation is displayed on the right.</li>
<li>Variable distribution is available on the diagonal.</li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="linear-regression-in-r.html#cb75-1" tabindex="-1"></a><span class="co"># Check correlations (as scatterplots), distribution and print corrleation coefficient </span></span>
<span id="cb75-2"><a href="linear-regression-in-r.html#cb75-2" tabindex="-1"></a></span>
<span id="cb75-3"><a href="linear-regression-in-r.html#cb75-3" tabindex="-1"></a><span class="fu">ggpairs</span>(marketing, <span class="at">title=</span><span class="st">&quot;correlogram with ggpairs()&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="linear-regression-in-r.html#cb75-4" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="figure/unnamed-chunk-27-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li>The term <span class="math inline">\(corr\)</span> is the Pearson product-moment correlation coefficient (<span class="math inline">\(r\)</span>).</li>
<li>It is a measure of the <strong>linear</strong> correlation of two variables.</li>
<li>It is a number that ranges from -1 to 0 to +1, representing th strength of the linear relationship between the variables.</li>
<li>An <span class="math inline">\(r\)</span> value of <span class="math inline">\(+1\)</span> denotes a perfect <strong>linear</strong> positive relationship between two variables.</li>
<li>An <span class="math inline">\(r\)</span> value of <span class="math inline">\(-1\)</span> denotes a perfect <strong>linear</strong> negative relationship between two variables, which indicates an inverse relationship between two variables: as one variable gets larger, the other gets smaller.</li>
<li>An <span class="math inline">\(r\)</span> value of 0 means no <strong>linear</strong> relationship is present between the two variables (There can be a non-linear relationship.)</li>
</ul>
</div>
</div>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> Simple Linear Regression<a href="linear-regression-in-r.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>The most elementary regression model is called <strong>simple linear regression</strong>.</p></li>
<li><p>The variable to be predicted is called the <em>dependent variable</em> an is denoted by <span class="math inline">\(y\)</span>.</p></li>
<li><p>The <em>predictor</em> is called the <em>independent variable</em> or <em>explanatory variable</em> and is denoted by <span class="math inline">\(x\)</span></p></li>
<li><p>In simple <em>linear</em> regression analysis, only a strait-line relationship between two variables is examined.</p></li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="linear-regression-in-r.html#cb76-1" tabindex="-1"></a><span class="co">#lm(y ~ x)</span></span>
<span id="cb76-2"><a href="linear-regression-in-r.html#cb76-2" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> facebook,  <span class="at">data =</span> marketing)</span>
<span id="cb76-3"><a href="linear-regression-in-r.html#cb76-3" tabindex="-1"></a></span>
<span id="cb76-4"><a href="linear-regression-in-r.html#cb76-4" tabindex="-1"></a>reg</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ facebook, data = marketing)
## 
## Coefficients:
## (Intercept)     facebook  
##     11.1740       0.2025</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="linear-regression-in-r.html#cb78-1" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ facebook, data = marketing)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -18.8766  -2.5589   0.9248   3.3330   9.8173 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 11.17397    0.67548  16.542   &lt;2e-16 ***
## facebook     0.20250    0.02041   9.921   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.13 on 198 degrees of freedom
## Multiple R-squared:  0.332,  Adjusted R-squared:  0.3287 
## F-statistic: 98.42 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="residual-analysis" class="section level3 hasAnchor" number="3.11.1">
<h3><span class="header-section-number">3.11.1</span> Residual Analysis<a href="linear-regression-in-r.html#residual-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<<<<<<< HEAD
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="linear-regression-in-r.html#cb80-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb80-2"><a href="linear-regression-in-r.html#cb80-2" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code></pre></div>
=======
<<<<<<< HEAD
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="linear-regression-in-r.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb82-2"><a href="linear-regression-in-r.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code></pre></div>
=======
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="linear-regression-in-r.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb80-2"><a href="linear-regression-in-r.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg)</span></code></pre></div>
>>>>>>> db2d36962e520f9ed1862fd4eb2c519e8da84f67
>>>>>>> 6da6143e6ad07463649fb2aae6d4caebd3bea4f0
<p><img src="figure/unnamed-chunk-29-1.png" width="960" style="display: block; margin: auto;" /></p>
<ul>
<li><p>You want these plots to display random residuals (no patterns) that are uncorrelated and uniform.</p></li>
<li><p>Generally speaking, if you see patterns in the residuals, your model has a problem, and you might not be able to trust the results.</p></li>
<li><p>Heteroscedasticity produces a distinctive fan or cone shape in residual plots.</p></li>
<li><p>To check for heteroscedasticity, you need to assess the residuals by fitted value plots specifically.</p></li>
<li><p>Typically, the telltale pattern for heteroscedasticity is that as the fitted values increases, the variance of the residuals also increases.</p></li>
</ul>
<p>Read more about residual analysis:</p>
<ul>
<li>Montgomery, D. C., Peck, E. A., &amp; Vining, G. G. (2012). Introduction to linear regression analysis (Vol. 821). John Wiley &amp; Sons.</li>
</ul>
</div>
</div>
<div id="multiple-linear-regression" class="section level2 hasAnchor" number="3.12">
<h2><span class="header-section-number">3.12</span> Multiple Linear Regression<a href="linear-regression-in-r.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Regression models with more than one independent variable can be explored by using multiple regression models.</p></li>
<li><p>We want to build a model for estimating sales based on the advertising budget invested in youtube, facebook and newspaper, as follow:</p></li>
</ul>
<p><span class="math display">\[sales = \beta_0 + \beta_1*youtube + \beta_2*facebook + \beta_3*newspaper\]</span></p>
<p>You can compute the model coefficients in R as follow:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="linear-regression-in-r.html#cb81-1" tabindex="-1"></a>m_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> youtube <span class="sc">+</span> facebook <span class="sc">+</span> newspaper, <span class="at">data =</span> marketing)</span>
<span id="cb81-2"><a href="linear-regression-in-r.html#cb81-2" tabindex="-1"></a><span class="fu">summary</span>(m_reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ youtube + facebook + newspaper, data = marketing)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.5932  -1.0690   0.2902   1.4272   3.3951 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.526667   0.374290   9.422   &lt;2e-16 ***
## youtube      0.045765   0.001395  32.809   &lt;2e-16 ***
## facebook     0.188530   0.008611  21.893   &lt;2e-16 ***
## newspaper   -0.001037   0.005871  -0.177     0.86    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.023 on 196 degrees of freedom
## Multiple R-squared:  0.8972, Adjusted R-squared:  0.8956 
## F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
<div id="how-to-test-if-your-linear-model-has-a-good-fit" class="section level3 hasAnchor" number="3.12.1">
<h3><span class="header-section-number">3.12.1</span> How to test if your linear model has a good fit?<a href="linear-regression-in-r.html#how-to-test-if-your-linear-model-has-a-good-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Most common value to check how good is your model is the coefficient of determinations or <span class="math inline">\(R^2\)</span></p></li>
<li><p>As we have seen in simple linear regression, the overall quality of the model can be assessed by examining the R-squared (<span class="math inline">\(R^2\)</span>).</p></li>
<li><p><span class="math inline">\(R^2=0.05602\)</span> means that the model explains only 5% of the data variability.</p></li>
<li><p><span class="math inline">\(R^2\)</span> represents the proportion of variance, in the outcome variable <span class="math inline">\(y\)</span>, that may be predicted by knowing the value of the <span class="math inline">\(x\)</span> variables.</p></li>
<li><p>An <span class="math inline">\(R^2\)</span> value close to 1 indicates that the model explains a large portion of the variance in the outcome variable.</p></li>
<li><p>The second one has an <span class="math inline">\(R^2\)</span> of 0.89, and the model can explain <span class="math inline">\(89\%\)</span> of the total variability.</p></li>
<li><p>In the regression summary output notice that there’s two different <span class="math inline">\(R^2\)</span>, one multiple and one adjusted.</p></li>
<li><p>One problem with this <span class="math inline">\(R^2\)</span> is that it will always increase when more variables are added to the model, even if those variables are only weakly associated with the response (i.e. these variables don’t add anything to your predictions)</p></li>
<li><p>For this reason, the <strong>adjusted</strong> <span class="math inline">\(R^2\)</span> is probably better to look at if you are adding more than one variable to the model, since it only increases if it reduces the overall error of the predictions.</p></li>
<li><p>The adjustment in the <strong>Adjusted R Square</strong> value in the summary output is a correction for the number of x variables included in the prediction model.</p></li>
</ul>
<p><strong>NOTE</strong></p>
<p><em>In our example, with youtube, newspaper and facebook predictor variables, the adjusted</em> <span class="math inline">\(R^2 = 0.89\)</span>, <em>meaning that “89% of the variance in the measure of sales can be predicted by youtube, newspaper and facebook advertising budgets.</em></p>
<p><em>This model is better than the simple linear model with only facebook, which had an adjusted</em> <span class="math inline">\(R^2\)</span> <em>of 0.05.</em></p>
</div>
<div id="dont-forget-to-look-at-the-residuals" class="section level3 hasAnchor" number="3.12.2">
<h3><span class="header-section-number">3.12.2</span> Don’t forget to look at the residuals<a href="linear-regression-in-r.html#dont-forget-to-look-at-the-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>You can have a pretty good <span class="math inline">\(R^2\)</span> in your model, but let’s not rush to conclusions here.</p></li>
<li><p>Ideally, when you plot the residuals, they should look random. Otherwise, it means that maybe there is a hidden pattern that the linear model is not considering.</p></li>
</ul>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="linear-regression-in-r.html#cb83-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb83-2"><a href="linear-regression-in-r.html#cb83-2" tabindex="-1"></a><span class="fu">plot</span>(m_reg)</span></code></pre></div>
<p><img src="figure/unnamed-chunk-31-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="prediction-for-new-data-set" class="section level2 hasAnchor" number="3.13">
<h2><span class="header-section-number">3.13</span> Prediction for new data set<a href="linear-regression-in-r.html#prediction-for-new-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Using the above model, we can predict the sales for a new advertising budget.</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="linear-regression-in-r.html#cb84-1" tabindex="-1"></a>new.budget <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb84-2"><a href="linear-regression-in-r.html#cb84-2" tabindex="-1"></a>  <span class="at">youtube =</span> <span class="fu">c</span>(<span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">100</span>),</span>
<span id="cb84-3"><a href="linear-regression-in-r.html#cb84-3" tabindex="-1"></a>  <span class="at">facebook =</span> <span class="fu">c</span>( <span class="dv">150</span>, <span class="dv">100</span>, <span class="dv">200</span>),</span>
<span id="cb84-4"><a href="linear-regression-in-r.html#cb84-4" tabindex="-1"></a>  <span class="at">newspaper =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb84-5"><a href="linear-regression-in-r.html#cb84-5" tabindex="-1"></a>)</span>
<span id="cb84-6"><a href="linear-regression-in-r.html#cb84-6" tabindex="-1"></a>new.budget</span></code></pre></div>
<pre><code>##   youtube facebook newspaper
## 1     150      150         0
## 2     200      100         0
## 3     100      200         0</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="linear-regression-in-r.html#cb86-1" tabindex="-1"></a><span class="fu">predict</span>(m_reg, new.budget)</span></code></pre></div>
<pre><code>##        1        2        3 
## 38.67087 31.53260 45.80914</code></pre>
<p><strong>Simple Linear regression</strong></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="linear-regression-in-r.html#cb88-1" tabindex="-1"></a>new.facebook <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb88-2"><a href="linear-regression-in-r.html#cb88-2" tabindex="-1"></a>  <span class="at">facebook =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb88-3"><a href="linear-regression-in-r.html#cb88-3" tabindex="-1"></a>)</span>
<span id="cb88-4"><a href="linear-regression-in-r.html#cb88-4" tabindex="-1"></a></span>
<span id="cb88-5"><a href="linear-regression-in-r.html#cb88-5" tabindex="-1"></a><span class="fu">predict</span>(reg, new.facebook)</span></code></pre></div>
<pre><code>##        1        2        3 
## 21.29875 31.42354 51.67312</code></pre>
<div style="page-break-after: always;"></div>
</div>
<div id="references-1" class="section level2 hasAnchor" number="3.14">
<h2><span class="header-section-number">3.14</span> References<a href="linear-regression-in-r.html#references-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.scribbr.com/statistics/linear-regression-in-r/">https://www.scribbr.com/statistics/linear-regression-in-r/</a></p>
<p><a href="https://statisticsbyjim.com/regression/heteroscedasticity-regression/" class="uri">https://statisticsbyjim.com/regression/heteroscedasticity-regression/</a></p>
<div style="page-break-after: always;"></div>
<p>hypothesis testing part</p>
<p><a href="http://www.sthda.com/english/articles/40-regression-analysis/168-multiple-linear-regression-in-r/" class="uri">http://www.sthda.com/english/articles/40-regression-analysis/168-multiple-linear-regression-in-r/</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mtcars.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
